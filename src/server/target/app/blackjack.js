define(["card","blackjack"],function(n,t){var t=function(n){this.nick=n,this.hand=[]};return t.prototype={BLACK_JACK:21,DEALER_THRESHOLD:17,getNick:function(){return this.nick},hand:function(){return this.hand},getHand:function(){return this.hand},handToJson:function(t){var i={};return i.cards=[],this.hand.forEach(function(h,a){var r=new n(h);i.cards.push(r.getJson(0===a&&t))}),i},isBusted:function(){var n=this.getTotal(!0);return n>this.BLACK_JACK},hit:function(n){this.hand.push(n)},stand:function(){},getTotal:function(n){var t=this.testHand||this.hand,i={};return i.low=i.high=0,t.forEach(function(n){n=n>10?10:n,i.low+=n,i.high+=1===n?11:n}),n?this.getOptimal(i):i},getOptimal:function(n){var t=n.low,i=n.high;return t!==i?i>21?t:21-t>21-i?i:t:i}},t});